{
  "name": "get_report_visits_yandex_metric_async",
  "description": "Формирование отчёта из Яндекс.Метрики (Reports API) в асинхронном режиме. Поддерживаются preset и 'человеческие' запросы. Все параметры опциональны: можно указать их явно или передать query, из которого они будут извлечены.",
  "parameters": {
    "type": "object",
    "properties": {
      "ids": {
        "type": "string",
        "description": "ID счётчика Яндекс.Метрики. Может быть указан явно или извлечён из query."
      },
      "date1": {
        "type": "string",
        "description": "Начальная дата периода (строго в формате YYYY-MM-DD). Может быть указана явно или извлечена из query."
      },
      "date2": {
        "type": "string",
        "description": "Конечная дата периода (строго в формате YYYY-MM-DD). Может быть указана явно или извлечена из query."
      },
      "lang": {
        "type": "string",
        "enum": ["ru", "en"],
        "description": "Язык интерфейса (по умолчанию ru). Может быть указан явно или извлечён из query."
      },
      "preset": {
        "type": "string",
        "description": "Название шаблона отчёта (например: traffic, conversion, sources_social). Может быть указано явно или определено автоматически из query."
      },
      "metrics": {
        "type": "string",
        "description": "Список метрик через запятую (например: 'ym:s:visits,ym:s:pageviews'). Используется в ручном режиме вместо preset."
      },
      "dimensions": {
        "type": "string",
        "description": "Список группировок через запятую (например: 'ym:s:trafficSource,ym:s:deviceCategory'). Используется в ручном режиме вместо preset."
      },
      "filters": {
        "type": "string",
        "description": "Строка фильтрации в формате API (например: \"ym:s:deviceCategory=='mobile'\"). Применяется только в ручном режиме."
      },
      "query": {
        "type": "string",
        "description": "Человеческий запрос (например: 'отчёт по посещаемости для счётчика 44147844 за период с 2024-01-01 по 2024-01-31'). Используется для автоматического выбора preset, ids, дат и языка."
      },
      "token": {
        "type": "string",
        "description": "OAuth‑токен Яндекс.Метрики. Если не указан, используется значение из переменной окружения YANDEX_METRIKA_TOKEN."
      }
    },
    "required": []
  }
}
